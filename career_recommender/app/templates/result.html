{% extends "base.html" %}
{% block content %}

<style>
.result-header {
    background: linear-gradient(90deg, #4c8bf5, #00c6a7);
    color: white;
    padding: 25px;
    border-radius: 14px;
    text-align: center;
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.result-card {
    border-radius: 16px;
    padding: 25px;
    background: rgba(255,255,255,0.9);
    backdrop-filter: blur(8px);
    box-shadow: 0 5px 30px rgba(0,0,0,0.08);
    margin-top: 25px;
}

.role-box {
    padding: 18px;
    border-radius: 14px;
    border-left: 6px solid #4c8bf5;
    background: #f1f6ff;
    margin-bottom: 22px;
}

.role-box h5 {
    font-weight: 700;
}

.chart-card {
    margin-top: 30px;
    padding: 20px;
    border-radius: 16px;
    background: #ffffff;
    box-shadow: 0 5px 30px rgba(0,0,0,0.1);
}
</style>

<div class="result-header">
    <h2 class="fw-bold">Resume Analysis Results</h2>
    <p class="mb-0">AI-Powered Career Insights Based on Your Resume</p>
</div>

<div class="container mt-4">

    <!-- AI GENERATED SUMMARY -->
    <div class="result-card">
        <h4 class="mb-3 fw-bold">ðŸ§  AI Summary</h4>
        <div class="p-3 rounded" style="background:#eef9ff;border-left:5px solid #4c8bf5;">
            <p class="mb-0">{{ parsed.ai_summary }}</p>
        </div>
    </div>

    <!-- TOP CAREER MATCHES -->
    <div class="result-card">
        <h4 class="fw-bold mb-3">ðŸŽ¯ Top Career Recommendations</h4>

        {% for r in top3 %}
        <div class="role-box">
            <h5>
                {{ r.label }}
                <span class="text-muted">({{ "%.2f"|format(r.score*100) }}%)</span>
            </h5>

            <p class="mt-2 mb-1 fw-semibold">Matched Job Titles:</p>
            <ul>
                {% for rr in r.raw_roles %}
                <li>{{ rr }}</li>
                {% endfor %}
            </ul>

            {% if r.summary %}
            <p><b>AI Insight:</b> {{ r.summary }}</p>
            {% endif %}
        </div>
        {% endfor %}

    </div>

    <!-- SKILL MATCH GRAPH -->
    <div class="chart-card">
        <h4 class="fw-bold">ðŸ“Š Skill Match Graph</h4>
        <canvas id="skillChart" height="120"></canvas>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
// Top role list for labels
let labels = {{ top3[0].raw_roles[:5] | safe }};
let values = labels.map(() => Math.random() * 100);  // demo values

new Chart(document.getElementById("skillChart"), {
    type: "bar",
    data: {
        labels: labels,
        datasets: [{
            label: "Match Score (%)",
            data: values,
            backgroundColor: "rgba(76,139,245,0.8)",
            borderRadius: 8
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: { beginAtZero: true }
        }
    }
});
</script>

{% endblock %}
