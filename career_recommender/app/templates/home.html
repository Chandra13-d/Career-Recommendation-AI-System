{% extends "base.html" %}
{% block content %}

<!-- HERO SECTION -->
<section class="home-hero text-center py-5 mb-4">
    <h1 class="fw-bold display-5">AI Career Recommendation System</h1>
    <p class="lead">Upload your resume or enter skills to get AI-powered career predictions</p>
</section>

<div class="row g-4">

    <!-- QUICK PREDICT BOX -->
    <div class="col-md-6">
        <div class="home-card p-4 shadow">
            <h4 class="fw-bold">âš¡ Quick Predict (Enter Skills)</h4>
            <input id="skillInput" class="form-control mt-2" placeholder="python, sql, excel, ml">

            <button id="quickPredict" class="btn btn-primary mt-3 w-100">
                Predict Career ðŸš€
            </button>

            <div id="quickResult" class="mt-3 d-none">
                <h5 class="fw-bold mt-3">ðŸ”® Top Predictions</h5>
                <div id="quickList"></div>
            </div>
        </div>
    </div>

    <!-- UPLOAD RESUME BOX -->
    <div class="col-md-6">
        <div class="home-card p-4 shadow">
            <h4 class="fw-bold">ðŸ“„ Upload Resume</h4>
            <p class="text-muted">AI will extract skills, experience, education & contact.</p>
            <a href="{{ url_for('api.ui_upload') }}" class="btn btn-success w-100">
                Upload Resume & Predict ðŸ¤–
            </a>
        </div>
    </div>

</div>


<script>
document.getElementById("quickPredict").onclick = async () => {
    const input = document.getElementById("skillInput").value.trim();
    if (!input) return alert("Enter skills first!");

    const payload = {
        profile: { technical_skills: input.split(",").map(x=>x.trim()) },
        k: 3
    };

    const res = await fetch("/api/predict", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(payload)
    });

    const quickList = document.getElementById("quickList");
    const resultBox = document.getElementById("quickResult");

    quickList.innerHTML = "Loading...";
    resultBox.classList.remove("d-none");

    try {
        const data = await res.json();
        quickList.innerHTML = "";

        (data.top3 || []).forEach(r => {
            quickList.innerHTML += `
                <div class="result-item mb-2">
                    <b>${r.label}</b> â€¢ ${(r.score * 100).toFixed(2)}%
                    <div class="small text-muted">
                        ${(r.raw_roles || []).slice(0, 5).join(" | ")}
                    </div>
                </div>
                <hr>
            `;
        });

    } catch (e) {
        quickList.innerHTML = "<span class='text-danger'>Prediction failed.</span>";
    }
};
</script>

<style>
.home-hero {
    background: linear-gradient(135deg, #4c8bf5, #00c6a7);
    color: white;
    border-radius: 16px;
}

.home-card {
    background: #fff;
    border-radius: 12px;
    border: 1px solid #e8eef5;
    transition: 0.3s;
}

.home-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 30px rgba(0,0,0,0.1);
}

.result-item {
    font-size: 1.1rem;
}
</style>

{% endblock %}
